%*** TRZ100.RDL
%***
%**  Copyright (c) 1996, Mincom Pty Ltd, Brisbane 4120, Australia.
%*** All rights reserved.
%***
%*** Revision History ***
%*** 30-Nov-12 a9nh4814     MO164 - Version 0001
%*** .....................  Reset version to 0001 for Ellipse 8 migration.
%*** 15-Apr-98 EFredeluces  W804060032
%*** .....................  To include the employee surname and initials.
%*** 30-Oct-96 Capple   
%*** .....................  Selectif changed to reduce if statements.
%*** .....................  All subscripts removed and reference made 
%*** .....................  directly to fields.
%*** 17-Jul-96 Autogen      Initial Coding.
%*** .....................  Generated by Version 001D of GENAUDIT.MAC.
%***
%PROGRAM-ID
       TRZ100
%AUTHOR
       Mincom PTY LTD
%NARRATIVE
      **  This program produces the audit records 
%VERSION
       0001
%MODULE
       3001
%FILES
        MFILE = MSF034
        LFILE = MSF100
        LFILE = MSF810
        RFILE = TRZ100A
%ROUTINES
        MSSDAT
        MSSCNV
%SELECTION
       WHERE    (DATE-GMT >= %FRDATE%)
       STOPIF   (%TODATE% <> SPACES, -
                 DATE-GMT  > %TODATE%)             
%AUDITING-DATASETS
       MSF100
%REQUEST-PARAMETERS
       IMODF    PIC (X(1))    TEXT 'Modified fields only                      : '
       FRDATE   PIC (X(8))    TEXT 'From date                                 : '
       TODATE   PIC (X(8))    TEXT 'To date                                   : '
       ITYP     PIC (X(1))    TEXT 'Type (A)ll (C)reated (M)odified (D)eleted : '
       IUSER    PIC (X(10))   TEXT 'User id                                   : '
%REPORT-TITLE
'AUDIT TRAIL REPORT - SUPPLY CATALOGUE FILE (MSF100)'
%PAGE HEADING
'TYPE     KEY                                            DATE       TIME    USER ID     EMPLOYEE NAME                    PROGRAM'
%DETAIL TEST-PAGE(14)
<IF CTYP = 'Y' AND CUSR = 'Y' AND CDTE = 'Y'>
<IF KEYB1 = SPACES>

{ATYP   } {KEYA1     }                                 {ADTE    } {ATIM  }  {AUSER   }  {ENAME                         } {APROG }
<ELSE>

{ATYP   } {KEYB1     }                                 {ADTE    } {ATIM  }  {AUSER   }  {ENAME                         } {APROG }
<ENDIF>
<IF %IMODF% = 'N'>
        <IF ATYP <> 'Modify'>
          {FN1         } {FD1                    } {F1Z1     }
          {FN2         } {FD2                    } {F2Z1                        }
          {FN41        } {FD41                   } {F4Z11 }
          {FN42        } {FD42                   } {F4Z12 }
          {FN43        } {FD43                   } {F4Z13 }
          {FN44        } {FD44                   } {F4Z14 }
          {FN45        } {FD45                   } {F4Z15 }
          {FN46        } {FD46                   } {F4Z16 }
          {FN47        } {FD47                   } {F4Z17 }
          {FN48        } {FD48                   } {F4Z18 }
          {FN49        } {FD49                   } {F4Z19 }
          {FN410       } {FD410                  } {F4Z110}
          {FN5         } {FD5                    } {F5Z1  }
          {FN6         } {FD6                    } {F6Z1  }
          {FN7         } {FD7                    } {F7Z1  }
          {FN8         } {FD8                    } {F8Z1    }
          {FN9         } {FD9                    } {F9Z1      }
          {FN10        } {FD10                   } {F10Z1 }
          {FN11        } {FD11                   } {F11Z1 }

          {FN12        } {FD12                   } {F12Z1 }
          {FN13        } {FD13                   } {F13Z1   }
          {FN14        } {FD14                   } {F14Z1 }
          {FN15        } {FD15                   } {F15Z1     }
          {FN16        } {FD16                   } {F16Z1   }
          {FN17        } {FD17                   } {F17Z1 }
          {FN18        } {FD18                   } {F18Z1             }
          {FN19        } {FD19                   } {F19Z1                                   }
          {FN201       } {FD201                  } {F20Z11                                  }
          {FN202       } {FD202                  } {F20Z12                                  }
          {FN203       } {FD203                  } {F20Z13                                  }
          {FN204       } {FD204                  } {F20Z14                                  }
          {FN21        } {FD21                   } {F21Z1}
          {FN24        } {FD24                   } {F24Z1 }
          {FN26        } {FD26                   } {F26Z1 }
        <ELSE>
          {FN1         } {FD2                    } {F1B1     }
                                                   {F1A1     }
          {FN2         } {FD2                    } {F2B1                        }
                                                   {F2A1                        }
          {FN41        } {FD41                   } {F4B11 }
                                                   {F4A11 }
          {FN42        } {FD42                   } {F4B12 }
                                                   {F4A12 }
          {FN43        } {FD43                   } {F4B13 }
                                                   {F4A13 }
          {FN44        } {FD44                   } {F4B14 }
                                                   {F4A14 }
          {FN45        } {FD45                   } {F4B15 }
                                                   {F4A15 }
          {FN46        } {FD46                   } {F4B16 }
                                                   {F4A16 }
          {FN47        } {FD47                   } {F4B17 }
                                                   {F4A17 }
          {FN48        } {FD48                   } {F4B18 }
                                                   {F4A18 }
          {FN49        } {FD49                   } {F4B19 }
                                                   {F4A19 }
          {FN410       } {FD410                  } {F4B110}
                                                   {F4A110}
          {FN5         } {FD5                    } {F5B1  }
                                                   {F5A1  }
          {FN6         } {FD6                    } {F6B1  }
                                                   {F6A1  }
          {FN7         } {FD7                    } {F7B1  }
                                                   {F7A1  }
          {FN8         } {FD8                    } {F8B1    }
                                                   {F8A1    }
          {FN9         } {FD9                    } {F9B1      }
                                                   {F9A1      }
          {FN10        } {FD10                   } {F10B1 }
                                                   {F10A1 }
          {FN11        } {FD11                   } {F11B1 }
                                                   {F11A1 }
          {FN12        } {FD12                   } {F12B1 }
                                                   {F12A1 }
          {FN13        } {FD13                   } {F13B1   }
                                                   {F13A1   }
          {FN14        } {FD14                   } {F14B1 }
                                                   {F14A1 }
          {FN15        } {FD15                   } {F15B1     }
                                                   {F15A1     }
          {FN16        } {FD16                   } {F16B1   }
                                                   {F16A1   }
          {FN17        } {FD17                   } {F17B1 }
                                                   {F17A1 }
          {FN18        } {FD18                   } {F18B1 }
                                                   {F18A1 }
          {FN19        } {FD19                   } {F19B1                                   }
                                                   {F19A1                                   }
          {FN201       } {FD201                  } {F20B11                                  }
                                                   {F20A11                                  }
          {FN202       } {FD202                  } {F20B12                                  }
                                                   {F20A12                                  }
          {FN203       } {FD203                  } {F20B13                                  }
                                                   {F20A13                                  }
          {FN204       } {FD204                  } {F20B14                                  }
                                                   {F20A14                                  }
          {FN21        } {FD21                   } {F21B1 }
                                                   {F21A1 }
          {FN24        } {FD24                   } {F24B1 }
                                                   {F24A1 }
          {FN26        } {FD26                   } {F26B1 }
                                                   {F26A1 }
    <ENDIF>
<ELSE>
        <IF C11 = 'Y'>
          {FN1         } {FD1                   } {F1Z1     }
                <IF ATYP = 'Modify'>
                                                  {F1A1     }
                <ENDIF>
        <ENDIF>
        <IF C21 = 'Y'>
          {FN2         } {FD2                    } {F2Z1                        }
                <IF ATYP = 'Modify'>
                                                   {F2A1                        }
                <ENDIF>
        <ENDIF>
        <IF C411= 'Y'>
          {FN41        } {FD41                   } {F4Z11 }
                <IF ATYP = 'Modify'>
                                                   {F4A11 }
                <ENDIF>
        <ENDIF>
        <IF C412 = 'Y'>
          {FN42        } {FD42                   } {F4Z12 }
                <IF ATYP = 'Modify'>
                                                   {F4A12 }
                <ENDIF>
        <ENDIF>
        <IF C413 = 'Y'>
          {FN43        } {FD43                   } {F4Z13 }
                <IF ATYP = 'Modify'>
                                                   {F4A13 }
                <ENDIF>
        <ENDIF>
        <IF C414 = 'Y'>
          {FN44        } {FD44                   } {F4Z14 }
                <IF ATYP = 'Modify'>
                                                   {F4A14 }
                <ENDIF>
        <ENDIF>
        <IF C415 = 'Y'>
          {FN45        } {FD45                   } {F4Z15 }
                <IF ATYP = 'Modify'>
                                                   {F4A15 }
                <ENDIF>
        <ENDIF>
        <IF C416 = 'Y'>
          {FN46        } {FD46                   } {F4Z16 }
                <IF ATYP = 'Modify'>
                                                   {F4A16 }
                <ENDIF>
        <ENDIF>
        <IF C417 = 'Y'>
          {FN47        } {FD47                   } {F4Z17 }
                <IF ATYP = 'Modify'>
                                                   {F4A17 }
                <ENDIF>
        <ENDIF>
        <IF C418 = 'Y'>
          {FN48        } {FD48                   } {F4Z18 }
                <IF ATYP = 'Modify'>
                                                   {F4A18 }
                <ENDIF>
        <ENDIF>
        <IF C419 = 'Y'>
          {FN49        } {FD49                   } {F4Z19 }
                <IF ATYP = 'Modify'>
                                                   {F4A19 }
                <ENDIF>
        <ENDIF>
        <IF C4110 = 'Y'>
          {FN410       } {FD410                   } {F4Z110}
                <IF ATYP = 'Modify'>
                                                   {F4A110 }
                <ENDIF>
        <ENDIF>
        <IF C51 = 'Y'>
          {FN5         } {FD5                    } {F5Z1  }
                <IF ATYP = 'Modify'>
                                                   {F5A1  }
                <ENDIF>
        <ENDIF>
        <IF C61 = 'Y'>
          {FN6         } {FD6                    } {F6Z1  }
                <IF ATYP = 'Modify'>
                                                   {F6A1  }
                <ENDIF>
        <ENDIF>
        <IF C71 = 'Y'>
          {FN7         } {FD7                    } {F7Z1  }
                <IF ATYP = 'Modify'>
                                                   {F7A1  }
                <ENDIF>
        <ENDIF>
        <IF C81 = 'Y'>
          {FN8         } {FD8                    } {F8Z1    }
                <IF ATYP = 'Modify'>
                                                   {F8A1    }
                <ENDIF>
        <ENDIF>
        <IF C91 = 'Y'>
          {FN9         } {FD9                    } {F9Z1      }
                <IF ATYP = 'Modify'>
                                                   {F9A1      }
                <ENDIF>
        <ENDIF>
        <IF C101 = 'Y'>
          {FN10        } {FD10                   } {F10Z1 }
                <IF ATYP = 'Modify'>
                                                   {F10A1 }
                <ENDIF>
        <ENDIF>
        <IF C111 = 'Y'>
          {FN11        } {FD11                   } {F11Z1 }
                <IF ATYP = 'Modify'>
                                                   {F11A1 }
                <ENDIF>
        <ENDIF>
        <IF C121 = 'Y'>
          {FN12        } {FD12                   } {F12Z1 }
                <IF ATYP = 'Modify'>
                                                   {F12A1 }
                <ENDIF>
        <ENDIF>
        <IF C131 = 'Y'>
          {FN13        } {FD13                   } {F13Z1   }
                <IF ATYP = 'Modify'>
                                                   {F13A1   }
                <ENDIF>
        <ENDIF>
        <IF C141 = 'Y'>
          {FN14        } {FD14                   } {F14Z1 }
                <IF ATYP = 'Modify'>
                                                   {F14A1 }
                <ENDIF>
        <ENDIF>
        <IF C151 = 'Y'>
          {FN15        } {FD15                   } {F15Z1     }
                <IF ATYP = 'Modify'>
                                                   {F15A1     }
                <ENDIF>
        <ENDIF>
        <IF C161 = 'Y'>
          {FN16        } {FD16                   } {F16Z1   }
                <IF ATYP = 'Modify'>
                                                   {F16A1   }
                <ENDIF>
        <ENDIF>
        <IF C171 = 'Y'>
          {FN17        } {FD17                   } {F17Z1 }
                <IF ATYP = 'Modify'>
                                                   {F17A1 }
                <ENDIF>
        <ENDIF>
        <IF C181 = 'Y'>
          {FN18        } {FD18                   } {F18Z1             }
                <IF ATYP = 'Modify'>
                                                   {F18A1             }
                <ENDIF>
        <ENDIF>
        <IF C191 = 'Y'>
          {FN19        } {FD19                   } {F19Z1                                   }
                <IF ATYP = 'Modify'>
                                                   {F19A1                                   }
                <ENDIF>
        <ENDIF>
        <IF C2011 = 'Y'>
          {FN201       } {FD201                  } {F20Z11                                  }
                <IF ATYP = 'Modify'>
                                                   {F20A11                                  }
                <ENDIF>
        <ENDIF>
        <IF C2012 = 'Y'>
          {FN202       } {FD202                  } {F20Z12                                   }
                <IF ATYP = 'Modify'>
                                                   {F20A12                                   }
                <ENDIF>
        <ENDIF>
        <IF C2013 = 'Y'>
          {FN203       } {FD203                  } {F20Z13                                   }
                <IF ATYP = 'Modify'>
                                                   {F20A13                                   }
                <ENDIF>
        <ENDIF>
        <IF C2014 = 'Y'>
          {FN204       } {FD204                  } {F20Z14                                   }
                <IF ATYP = 'Modify'>
                                                   {F20A14                                   }
                <ENDIF>
        <ENDIF>
        <IF C211 = 'Y'>
          {FN21        } {FD21                   } {F21Z1 }
                <IF ATYP = 'Modify'>
                                                   {F21A1 }
                <ENDIF>
        <ENDIF>
        <IF C241 = 'Y'>
          {FN24        } {FD24                   } {F24Z1 }
                <IF ATYP = 'Modify'>
                                                   {F24A1 }
                <ENDIF>
        <ENDIF>
        <IF C261 = 'Y'>
          {FN26        } {FD26                   } {F26Z1 }
                <IF ATYP = 'Modify'>
                                                   {F26A1 }
                <ENDIF>
        <ENDIF>
<ENDIF>
<ENDIF>
%REPORT-SUMMARY



                                                 '*** END OF REPORT ***'

%VARIABLES
%*GET CURRENT DATE
    XDAT    = WX-TODAYS-DATE        CONSTANT
%*GET YETERDAYS DATE
    YDATT   = DATE2 OF MSSDAT             -
            WHERE  (OPTION = '1',  -
                DATE1 = XDAT, -
                DAYS  = -1) CONSTANT
%*SET DEFAULT DATE RANGES
    TDATE   = CHOOSE(YDATT IF(%TODATE% = '        '), -
                         YDATT IF(%TODATE% = '00000000'), -
                         %TODATE%) I-PIC(9(8))  CONSTANT
    FDATE   = CHOOSE(YDATT IF(%FRDATE% = '        '), -     
              YDATT IF(%FRDATE% = '00000000'), -     
              %FRDATE%) I-PIC(9(8)) CONSTANT
    CDTE  = CHOOSE ('Y' IF (DATE-GMT >= FDATE AND DATE-GMT <= TDATE), -
                      'N')			  
%*GET SURNAME AND FIRSTNAME
       EMPF   = USER-ID
       EMP    = SUBSTR (EMPF,2,5)       D-PIC (X(5))
       EMPID  = CATENATE ('00000',EMP)  D-PIC (X(10))
       SNAME  = SURNAME OF MSF810 - 
                     WHERE (EMPLOYEE-ID = EMPID)
       FNAME  = FIRST-NAME  VIA (SNAME)
       NAME   = CATENATE (SNAME,' ',FNAME)
       ENAME  = OUT-STRING OF MSSCNV -
                     WHERE (OPTION     = 'P', -
                            INP-STRING = NAME)
       FN1    = 'STOCK CODE'                    CONSTANT
       FD1    = 'Stock code'                    CONSTANT
       FN2    = 'CATEG-ID'                      CONSTANT
       FD2    = 'Category Identification'       CONSTANT
       FN41   = 'STOCK-SECTION - 1'             CONSTANT
       FD41   = 'Internal stock section 1 '     CONSTANT
       FN42   = 'STOCK-SECTION - 2'             CONSTANT
       FD42   = 'Internal stock section 2 '     CONSTANT
       FN43   = 'STOCK-SECTION - 3'             CONSTANT
       FD43   = 'Internal stock section 3 '     CONSTANT
       FN44   = 'STOCK-SECTION - 4'             CONSTANT
       FD44   = 'Internal stock section 4 '     CONSTANT
       FN45   = 'STOCK-SECTION - 5'             CONSTANT
       FD45   = 'Internal stock section 5 '     CONSTANT
       FN46   = 'STOCK-SECTION - 6'             CONSTANT
       FD46   = 'Internal stock section 6 ' CONSTANT
       FN47   = 'STOCK-SECTION - 7'         CONSTANT
       FD47   = 'Internal stock section 7 ' CONSTANT
       FN48   = 'STOCK-SECTION - 8'         CONSTANT
       FD48   = 'Internal stock section 8 ' CONSTANT
       FN49   = 'STOCK-SECTION - 9'         CONSTANT
       FD49   = 'Internal stock section 9 ' CONSTANT
       FN410  = 'STOCK-SECTION - 10'       CONSTANT
       FD410  = 'Internal stock section 10' CONSTANT
       FN5    = 'CLASS'                     CONSTANT
       FD5    = 'Stock Classification'      CONSTANT
       FN6    = 'STOCK-TYPE'                CONSTANT
       FD6    = 'Stock Type'                CONSTANT
       FN7    = 'UNIT-OF-ISSUE'             CONSTANT
       FD7    = 'Standard UOI for stock it' CONSTANT
       FN8    = 'WEIGHT        STOCK-CODE'              CONSTANT
       FD8    = 'Weight of stock item in k' CONSTANT
       FN9    = 'VOLUME'                    CONSTANT
       FD9    = 'Volume in cubic metres/uo' CONSTANT
       FN10   = 'UN-TRANSP-CODE'            CONSTANT
       FD10   = 'United Nations transporta' CONSTANT
       FN11   = 'HAZARD-MAT'                CONSTANT
       FD11   = 'Hazardous Material Code'   CONSTANT
       FN12   = 'NEW-STK-REQ'               CONSTANT
       FD12   = 'New stock request form nu' CONSTANT
       FN13   = 'LAST-MOD-DATE'             CONSTANT
       FD13   = 'Last Modification Date'    CONSTANT
       FN14   = 'LAST-MOD-TIME'             CONSTANT
       FD14   = 'Last Modification Time'    CONSTANT
       FN15   = 'LAST-MOD-USER'             CONSTANT
       FD15   = 'Last Modification User Id' CONSTANT
       FN16   = 'CREATION-DATE'             CONSTANT
       FD16   = 'Date record created'       CONSTANT
       FN17   = 'AMEND-NO'                  CONSTANT
       FD17   = 'Amendment number of last'  CONSTANT
       FN18   = 'TEMPLATE-ID'               CONSTANT
       FD18   = 'Template Identifier'       CONSTANT
       FN19   = 'ITEM NAME'                 CONSTANT
       FD19   = 'Item Name line'          CONSTANT
       FN201  = 'DESC-LINE-1'               CONSTANT
       FD201  = 'Subscripted description 1' CONSTANT
       FN202  = 'DESC-LINE-2'               CONSTANT
       FD202  = 'Subscripted description 2' CONSTANT
       FN203  = 'DESC-LINE-3'               CONSTANT
       FD203  = 'Subscripted description 3' CONSTANT
       FN204  = 'DESC-LINE-4'               CONSTANT
       FD204  = 'Subscripted description 4' CONSTANT
       FN21   = 'PURCH-TRANS-IN'            CONSTANT
       FD21   = 'Flag for default Purch/Tr' CONSTANT
       FN24   = 'TRACKING-IND'              CONSTANT
       FD24   = 'Tracking Indicator'        CONSTANT
       FN26   = 'ENTITLE-FLAG'              CONSTANT
       FD26   = 'Subject to Entitlement Ch' CONSTANT
       AUD    = AUDIT-TYPE
       CTYP   = CHOOSE ('Y' IF (%ITYP% = SPACES), -
                        'Y' IF (%ITYP% = 'A'), -
                        'Y' IF (%ITYP% = 'C', AUD = 'W'), -
                        'Y' IF (%ITYP% = 'D', AUD = 'D'), -
                        'Y' IF (%ITYP% = 'M', AUD = 'A'), -
                        'Y' IF (%ITYP% = 'M', AUD = 'B'), -
                        'N')
       CUSR   = CHOOSE ('Y' IF (%IUSER% = SPACES), -
                        'Y' IF (%IUSER% = USER-ID), -
                        'N')
       ADTE   = DATE-GMT FORMAT (DATE)
       ATIM   = TIME-GMT FORMAT (TIME)
       AUSER  = USER-ID
       APROG  = PROGRAM-NAME
       ATYP   = CHOOSE ('Create' IF (AUD = 'W'), -
                        'Delete' IF (AUD = 'D'), -
                        'Modify')
       KEYB1 = BEFORE-VALUE (MSF100, KEY-100)
       KEYA1 = AFTER-VALUE (MSF100, KEY-100)
       C11    = CHANGED (MSF100, STOCK-CODE)
       F1B1   = BEFORE-VALUE (MSF100, STOCK-CODE)
       F1A1   = AFTER-VALUE (MSF100, STOCK-CODE)
       F1Z1   = CHOOSE (F1B1 IF (ATYP = 'Delete'), -
                        F1A1 IF (ATYP = 'Create'), -
                        F1B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C21    = CHANGED (MSF100, CATEG-ID)
       F2B1   = BEFORE-VALUE (MSF100, CATEG-ID)
       F2A1   = AFTER-VALUE (MSF100, CATEG-ID)
       F2Z1   = CHOOSE (F2B1 IF (ATYP = 'Delete'), -
                        F2A1 IF (ATYP = 'Create'), -
                        F2B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C411   = CHANGED (MSF100, STOCK-SECTION-1)
       F4B11  = BEFORE-VALUE (MSF100, STOCK-SECTION-1)
       F4A11  = AFTER-VALUE (MSF100, STOCK-SECTION-1)
       F4Z11  = CHOOSE (F4B11 IF (ATYP = 'Delete'), -
                        F4A11 IF (ATYP = 'Create'), -
                        F4B11 IF (ATYP = 'Modify'), -
                        SPACES)

       C412   = CHANGED (MSF100, STOCK-SECTION-2)
       F4B12  = BEFORE-VALUE (MSF100, STOCK-SECTION-2)
       F4A12  = AFTER-VALUE (MSF100, STOCK-SECTION-2)
       F4Z12  = CHOOSE (F4B12 IF (ATYP = 'Delete'), -
                        F4A12 IF (ATYP = 'Create'), -
                        F4B12 IF (ATYP = 'Modify'), -
                        SPACES)

       C413   = CHANGED (MSF100, STOCK-SECTION-3)
       F4B13  = BEFORE-VALUE (MSF100, STOCK-SECTION-3)
       F4A13  = AFTER-VALUE (MSF100, STOCK-SECTION-3)
       F4Z13  = CHOOSE (F4B13 IF (ATYP = 'Delete'), -
                        F4A13 IF (ATYP = 'Create'), -
                        F4B13 IF (ATYP = 'Modify'), -
                        SPACES)

       C414   = CHANGED (MSF100, STOCK-SECTION-4)
       F4B14  = BEFORE-VALUE (MSF100, STOCK-SECTION-4)
       F4A14  = AFTER-VALUE (MSF100, STOCK-SECTION-4)
       F4Z14  = CHOOSE (F4B14 IF (ATYP = 'Delete'), -
                        F4A14 IF (ATYP = 'Create'), -
                        F4B14 IF (ATYP = 'Modify'), -
                        SPACES)

       C415   = CHANGED (MSF100, STOCK-SECTION-5)
       F4B15  = BEFORE-VALUE (MSF100, STOCK-SECTION-5)
       F4A15  = AFTER-VALUE (MSF100, STOCK-SECTION-5)
       F4Z15  = CHOOSE (F4B15 IF (ATYP = 'Delete'), -
                        F4A15 IF (ATYP = 'Create'), -
                        F4B15 IF (ATYP = 'Modify'), -
                        SPACES)

       C416   = CHANGED (MSF100, STOCK-SECTION-6)
       F4B16  = BEFORE-VALUE (MSF100, STOCK-SECTION-6)
       F4A16  = AFTER-VALUE (MSF100, STOCK-SECTION-6)
       F4Z16  = CHOOSE (F4B16 IF (ATYP = 'Delete'), -
                        F4A16 IF (ATYP = 'Create'), -
                        F4B16 IF (ATYP = 'Modify'), -
                        SPACES)

       C417   = CHANGED (MSF100, STOCK-SECTION-7)
       F4B17  = BEFORE-VALUE (MSF100, STOCK-SECTION-7)
       F4A17  = AFTER-VALUE (MSF100, STOCK-SECTION-7)
       F4Z17  = CHOOSE (F4B17 IF (ATYP = 'Delete'), -
                        F4A17 IF (ATYP = 'Create'), -
                        F4B17 IF (ATYP = 'Modify'), -
                        SPACES)

       C418   = CHANGED (MSF100, STOCK-SECTION-8)
       F4B18  = BEFORE-VALUE (MSF100, STOCK-SECTION-8)
       F4A18  = AFTER-VALUE (MSF100, STOCK-SECTION-8)
       F4Z18  = CHOOSE (F4B18 IF (ATYP = 'Delete'), -
                        F4A18 IF (ATYP = 'Create'), -
                        F4B18 IF (ATYP = 'Modify'), -
                        SPACES)

       C419   = CHANGED (MSF100, STOCK-SECTION-9)
       F4B19  = BEFORE-VALUE (MSF100, STOCK-SECTION-9)
       F4A19  = AFTER-VALUE (MSF100, STOCK-SECTION-9)
       F4Z19  = CHOOSE (F4B19 IF (ATYP = 'Delete'), -
                        F4A19 IF (ATYP = 'Create'), -
                        F4B19 IF (ATYP = 'Modify'), -
                        SPACES)

       C4110   = CHANGED (MSF100, STOCK-SECTION-10)
       F4B110  = BEFORE-VALUE (MSF100, STOCK-SECTION-10)
       F4A110  = AFTER-VALUE (MSF100, STOCK-SECTION-10)
       F4Z110  = CHOOSE (F4B110 IF (ATYP = 'Delete'), -
                        F4A110 IF (ATYP = 'Create'), -
                        F4B110 IF (ATYP = 'Modify'), -
                        SPACES)

       C51    = CHANGED (MSF100, CLASS)
       F5B1   = BEFORE-VALUE (MSF100, CLASS)
       F5A1   = AFTER-VALUE (MSF100, CLASS)
       F5Z1   = CHOOSE (F5B1 IF (ATYP = 'Delete'), -
                        F5A1 IF (ATYP = 'Create'), -
                        F5B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C61    = CHANGED (MSF100, STOCK-TYPE)
       F6B1   = BEFORE-VALUE (MSF100, STOCK-TYPE)
       F6A1   = AFTER-VALUE (MSF100, STOCK-TYPE)
       F6Z1   = CHOOSE (F6B1 IF (ATYP = 'Delete'), -
                        F6A1 IF (ATYP = 'Create'), -
                        F6B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C71    = CHANGED (MSF100, UNIT-OF-ISSUE)
       F7B1   = BEFORE-VALUE (MSF100, UNIT-OF-ISSUE)
       F7A1   = AFTER-VALUE (MSF100, UNIT-OF-ISSUE)
       F7Z1   = CHOOSE (F7B1 IF (ATYP = 'Delete'), -
                        F7A1 IF (ATYP = 'Create'), -
                        F7B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C81    = CHANGED (MSF100, WEIGHT)
       F8B1   = BEFORE-VALUE (MSF100, WEIGHT)
       F8A1   = AFTER-VALUE (MSF100, WEIGHT)
       F8Z1   = CHOOSE (F8B1 IF (ATYP = 'Delete'), -
                        F8A1 IF (ATYP = 'Create'), -
                        F8B1 IF (ATYP = 'Modify'), -
                        ZERO)

       C91    = CHANGED (MSF100, VOLUME)
       F9B1   = BEFORE-VALUE (MSF100, VOLUME)
       F9A1   = AFTER-VALUE (MSF100, VOLUME)
       F9Z1   = CHOOSE (F9B1 IF (ATYP = 'Delete'), -
                        F9A1 IF (ATYP = 'Create'), -
                        F9B1 IF (ATYP = 'Modify'), -
                        ZERO)

       C101   = CHANGED (MSF100, UN-TRANSP-CODE)
       F10B1  = BEFORE-VALUE (MSF100, UN-TRANSP-CODE)
       F10A1  = AFTER-VALUE (MSF100, UN-TRANSP-CODE)
       F10Z1  = CHOOSE (F10B1 IF (ATYP = 'Delete'), -
                        F10A1 IF (ATYP = 'Create'), -
                        F10B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C111   = CHANGED (MSF100, HAZARD-MAT)
       F11B1  = BEFORE-VALUE (MSF100, HAZARD-MAT)
       F11A1  = AFTER-VALUE (MSF100, HAZARD-MAT)
       F11Z1  = CHOOSE (F11B1 IF (ATYP = 'Delete'), -
                        F11A1 IF (ATYP = 'Create'), -
                        F11B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C121   = CHANGED (MSF100, NEW-STK-REQ)
       F12B1  = BEFORE-VALUE (MSF100, NEW-STK-REQ)
       F12A1  = AFTER-VALUE (MSF100, NEW-STK-REQ)
       F12Z1  = CHOOSE (F12B1 IF (ATYP = 'Delete'), -
                        F12A1 IF (ATYP = 'Create'), -
                        F12B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C131   = CHANGED (MSF100, LAST-MOD-DATE)
       F13B1  = BEFORE-VALUE (MSF100, LAST-MOD-DATE)
       F13A1  = AFTER-VALUE (MSF100, LAST-MOD-DATE)
       F13Z1  = CHOOSE (F13B1 IF (ATYP = 'Delete'), -
                        F13A1 IF (ATYP = 'Create'), -
                        F13B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C141   = CHANGED (MSF100, LAST-MOD-TIME)
       F14B1  = BEFORE-VALUE (MSF100, LAST-MOD-TIME)
       F14A1  = AFTER-VALUE (MSF100, LAST-MOD-TIME)
       F14Z1  = CHOOSE (F14B1 IF (ATYP = 'Delete'), -
                        F14A1 IF (ATYP = 'Create'), -
                        F14B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C151   = CHANGED (MSF100, LAST-MOD-USER)
       F15B1  = BEFORE-VALUE (MSF100, LAST-MOD-USER)
       F15A1  = AFTER-VALUE (MSF100, LAST-MOD-USER)
       F15Z1  = CHOOSE (F15B1 IF (ATYP = 'Delete'), -
                        F15A1 IF (ATYP = 'Create'), -
                        F15B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C161   = CHANGED (MSF100, CREATION-DATE)
       F16B1  = BEFORE-VALUE (MSF100, CREATION-DATE)
       F16A1  = AFTER-VALUE (MSF100, CREATION-DATE)
       F16Z1  = CHOOSE (F16B1 IF (ATYP = 'Delete'), -
                        F16A1 IF (ATYP = 'Create'), -
                        F16B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C171   = CHANGED (MSF100, AMEND-NO)
       F17B1  = BEFORE-VALUE (MSF100, AMEND-NO)
       F17A1  = AFTER-VALUE (MSF100, AMEND-NO)
       F17Z1  = CHOOSE (F17B1 IF (ATYP = 'Delete'), -
                        F17A1 IF (ATYP = 'Create'), -
                        F17B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C181   = CHANGED (MSF100, TEMPLATE-ID)
       F18B1  = BEFORE-VALUE (MSF100, TEMPLATE-ID)
       F18A1  = AFTER-VALUE (MSF100, TEMPLATE-ID)
       F18Z1  = CHOOSE (F18B1 IF (ATYP = 'Delete'), -
                        F18A1 IF (ATYP = 'Create'), -
                        F18B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C191   = CHANGED (MSF100, ITEM-NAME)
       F19B1  = BEFORE-VALUE (MSF100, ITEM-NAME)
       F19A1  = AFTER-VALUE (MSF100, ITEM-NAME)
       F19Z1  = CHOOSE (F19B1 IF (ATYP = 'Delete'), -
                        F19A1 IF (ATYP = 'Create'), -
                        F19B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C2011  = CHANGED (MSF100, DESC-LINE-1)
       F20B11 = BEFORE-VALUE (MSF100, DESC-LINE-1)
       F20A11 = AFTER-VALUE (MSF100, DESC-LINE-1)
       F20Z11 = CHOOSE (F20B11 IF (ATYP = 'Delete'), -
                        F20A11 IF (ATYP = 'Create'), -
                        F20B11 IF (ATYP = 'Modify'), -
                        SPACES)

       C2012  = CHANGED (MSF100, DESC-LINE-2)
       F20B12 = BEFORE-VALUE (MSF100, DESC-LINE-2)
       F20A12 = AFTER-VALUE (MSF100, DESC-LINE-2)
       F20Z12 = CHOOSE (F20B12 IF (ATYP = 'Delete'), -
                        F20A12 IF (ATYP = 'Create'), -
                        F20B12 IF (ATYP = 'Modify'), -
                        SPACES)
       C2013  = CHANGED (MSF100, DESC-LINE-3)
       F20B13 = BEFORE-VALUE (MSF100, DESC-LINE-3)
       F20A13 = AFTER-VALUE (MSF100, DESC-LINE-3)
       F20Z13 = CHOOSE (F20B13 IF (ATYP = 'Delete'), -
                        F20A13 IF (ATYP = 'Create'), -
                        F20B13 IF (ATYP = 'Modify'), -
                        SPACES)
       C2014  = CHANGED (MSF100, DESC-LINE-4)
       F20B14 = BEFORE-VALUE (MSF100, DESC-LINE-4)
       F20A14 = AFTER-VALUE (MSF100, DESC-LINE-4)
       F20Z14 = CHOOSE (F20B14 IF (ATYP = 'Delete'), -
                        F20A14 IF (ATYP = 'Create'), -
                        F20B14 IF (ATYP = 'Modify'), -
                        SPACES)
       C211   = CHANGED (MSF100, PURCH-TRANS-IND)
       F21B1  = BEFORE-VALUE (MSF100, PURCH-TRANS-IND)
       F21A1  = AFTER-VALUE (MSF100, PURCH-TRANS-IND)
       F21Z1  = CHOOSE (F21B1 IF (ATYP = 'Delete'), -
                        F21A1 IF (ATYP = 'Create'), -
                        F21B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C241   = CHANGED (MSF100, TRACKING-IND)
       F24B1  = BEFORE-VALUE (MSF100, TRACKING-IND)
       F24A1  = AFTER-VALUE (MSF100, TRACKING-IND)
       F24Z1  = CHOOSE (F24B1 IF (ATYP = 'Delete'), -
                        F24A1 IF (ATYP = 'Create'), -
                        F24B1 IF (ATYP = 'Modify'), -
                        SPACES)

       C261   = CHANGED (MSF100, ENTITLE-FLAG)
       F26B1  = BEFORE-VALUE (MSF100, ENTITLE-FLAG)
       F26A1  = AFTER-VALUE (MSF100, ENTITLE-FLAG)
       F26Z1  = CHOOSE (F26B1 IF (ATYP = 'Delete'), -
                        F26A1 IF (ATYP = 'Create'), -
                        F26B1 IF (ATYP = 'Modify'), -
                        SPACES)

						
%* End of Program