%*** TRZACA.RDL - Audit Report for Advanced Contracts **** -- Version : 003
%*** Copyright (c) 2006, Mincom Pty Ltd, Brisbane 4120, Australia.
%*** All rights reserved.
%***
%*** Revision History ***
%*** 15-Jun-07 E Fredeluces SC1506181
%***                      To default to the previous day when the parameter
%***                      Date From/To is spaces.
%*** 19-Dec-06 G Presser  1300785            (version 002)
%*** .................... Get this program to work.
%*** 20-Apr-06 JN         P05110874 - Missing audits - reordered the 
%***                      AUDITING-DATASETS list to DESCENDING 
%***                      (Otherwise it dont work properly.)
%***                      Also reordered report - which may be req'd???
%***                      Also dropped 1st line if no detail to be printed.
%***                      to try and fix 
%*** 11-Apr-06 Autogen    Initial Coding.
%*** .................... Generated by Version AA9 of GENAUDIT.MAC.
%***
%PROGRAM-ID
       TRZACA
%AUTHOR
       Mincom PTY LTD
%NARRATIVE
      **  This program produces the audit records for changs made when approving invoices 
      **  via MSQ388. Files that are audited, include: MSF384, MSF385, MSF386, MSF387
%VERSION
       003 
%MODULE
       3001
%FILES
       MFILE = MSF034
       LFILE = MSF384
       LFILE = MSF385
       LFILE = MSF386
       LFILE = MSF387
       LFILE = MSF200
       RFILE = TRZACAA
%SELECTION
       WHERE    (DATE-GMT >= %IFRDTE%)
       STOPIF   (%ITODTE% <> SPACES, -
                 DATE-GMT  > %ITODTE%)
%ROUTINES
       MSSDAT
       MSSCNV
%AUDITING-DATASETS
       MSF387 
       MSF386
       MSF385
       MSF384
%ORDER
       ASCENDING PROGRAM-NAME
       ASCENDING USER-ID
       ASCENDING DATE-GMT
       ASCENDING TIME-GMT
       ASCENDING SEQNO
%REQUEST-PARAMETERS
       IMODF    PIC (X(1))    TEXT 'Modified fields only   : '
       IFRDTE   PIC (X(8))    TEXT 'From date              : '
       ITODTE   PIC (X(8))    TEXT 'To date                : '
       ITYP     PIC (X(1))    TEXT 'Modify type a/c/m/d    : '
       IUSER    PIC (X(10))   TEXT 'User id                : '
%TITLE
'Audit Report For Advanced Contracts'
%PAGE HEADING
'TYPE     CNTRCT P/E/C     DATE       TIME      USER ID  S/No PROGRAM'
'         Field Id         Field Description         Value B/A'
%CONTROL
   PAGE-WIDTH = 80
%DETAIL TEST-PAGE (3) 
%***  EF0607 <IF CTYP = 'Y' AND CUSR = 'Y'>
<IF CTYP = 'Y' AND CUSR = 'Y' AND CDTE = 'Y'>
  <IF FNUM = '384'>
   <IF %IMODF% <> 'Y' OR CHQ384 = 'Y'>
     <IF KEY384B1 = SPACES>

{ATYP   } {KEY384A1      } {ADTE    } {ATIM   } {AUSER }{ASEQ} {APROG }
     <ELSE>

{ATYP   } {KEY384B1      } {ADTE    } {ATIM   } {AUSER }{ASEQ} {APROG }
     <ENDIF>
'Contract Status: '{STAT} 'Supplier: '{SUPP}' -' {SNAME                       }
   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C1051 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN105         } {FD105                  } {F105B1        }
                                                     {F105A1        }
         <ELSE>
          {FN105         } {FD105                  } {F105Z1        }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN105         } {FD105                  } {F105B1        }
                                                     {F105A1        }
      <ELSE>
          {FN105         } {FD105                  } {F105Z1        }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C1101 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN110         } {FD110                  } {F110B1}
                                                     {F110A1}
         <ELSE>
          {FN110         } {FD110                  } {F110Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN110         } {FD110                  } {F110B1}
                                                     {F110A1}
      <ELSE>
          {FN110         } {FD110                  } {F110Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C1111 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN111         } {FD111                  } {F111B1}
                                                     {F111A1}
         <ELSE>
          {FN111         } {FD111                  } {F111Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN111         } {FD111                  } {F111B1}
                                                     {F111A1}
      <ELSE>
          {FN111         } {FD111                  } {F111Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C1121 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN112         } {FD112                  } {F112B1  }
                                                     {F112A1  }
         <ELSE>
          {FN112         } {FD112                  } {F112Z1  }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN112         } {FD112                  } {F112B1  }
                                                     {F112A1  }
      <ELSE>
          {FN112         } {FD112                  } {F112Z1  }
      <ENDIF>

   <ENDIF>
 <ENDIF>
  <IF FNUM = '385'>
   <IF %IMODF% <> 'Y' OR CHQ385 = 'Y'>
     <IF KEY385B1 = SPACES>

{ATYP   } {KEY385A1      } {ADTE    } {ATIM   } {AUSER }{ASEQ} {APROG }
     <ELSE>

{ATYP   } {KEY385B1      } {ADTE    } {ATIM   } {AUSER }{ASEQ} {APROG }
     <ENDIF>
   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C71 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN7           } {FD7                    } {F7B1          }
                                                     {F7A1          }
         <ELSE>
          {FN7           } {FD7                    } {F7Z1          }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN7           } {FD7                    } {F7B1          }
                                                     {F7A1          }
      <ELSE>
          {FN7           } {FD7                    } {F7Z1          }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C141 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN14          } {FD14                   } {F14B1 }
                                                     {F14A1 }
         <ELSE>
          {FN14          } {FD14                   } {F14Z1 }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN14          } {FD14                   } {F14B1 }
                                                     {F14A1 }
      <ELSE>
          {FN14          } {FD14                   } {F14Z1 }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C151 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN15        } {FD15O                  } {F14A1 }
                         {FD15A                  } {F15B1 }
                         {FD15L                  } {F15A1 }
         <ELSE>
          {FN15        } {FD15                   } {F15Z1 }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN15        } {FD15O                  } {F14A1 }
                         {FD15A                  } {F15B1 }
                         {FD15L                  } {F15A1 }
      <ELSE>
          {FN15        } {FD15                   } {F15Z1 }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C231 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN23        } {FD23                   } {F23B1     }
                                                   {F23A1     }
         <ELSE>
          {FN23        } {FD23                   } {F23Z1     }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN23        } {FD23                   } {F23B1     }
                                                   {F23A1     }
      <ELSE>
          {FN23        } {FD23                   } {F23Z1     }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C241 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN24        } {FD24                   } {F24B1}
                                                   {F24A1}
         <ELSE>
          {FN24        } {FD24                   } {F24Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN24        } {FD24                   } {F24B1}
                                                   {F24A1}
      <ELSE>
          {FN24        } {FD24                   } {F24Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C251 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN25        } {FD25                   } {F25B1         }
                                                   {F25A1         }
         <ELSE>
          {FN25        } {FD25                   } {F25Z1         }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN25        } {FD25                   } {F25B1         }
                                                   {F25A1         }
      <ELSE>
          {FN25        } {FD25                   } {F25Z1         }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C2W1 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN2W          } {FD2W                   } {F2WB1     }
                                                     {F2WA1     }
         <ELSE>
          {FN2W          } {FD2W                   } {F2WZ1     }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN2W          } {FD2W                   } {F2WB1     }
                                                     {F2WA1     }
      <ELSE>
          {FN2W          } {FD2W                   } {F2WZ1     }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C281 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN28        } {FD28                   } {F28B1}
                                                   {F28A1}
         <ELSE>
          {FN28        } {FD28                   } {F28Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN28        } {FD28                   } {F28B1}
                                                   {F28A1}
      <ELSE>
          {FN28        } {FD28                   } {F28Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C291 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN29        } {FD29                   } {F29B1     }
                                                   {F29A1     }
         <ELSE>
          {FN29        } {FD29                   } {F29Z1     }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN29        } {FD29                   } {F29B1     }
                                                   {F29A1     }
      <ELSE>
          {FN29        } {FD29                   } {F29Z1     }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C301 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN30        } {FD30                   } {F30B1}
                                                   {F30A1}
         <ELSE>
          {FN30        } {FD30                   } {F30Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN30        } {FD30                   } {F30B1}
                                                   {F30A1}
      <ELSE>
          {FN30        } {FD30                   } {F30Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C711 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN71          } {FD71                   } {F71B1 }
                                                     {F71A1 }
         <ELSE>
          {FN71          } {FD71                   } {F71Z1 }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN71          } {FD71                   } {F71B1 }
                                                     {F71A1 }
      <ELSE>
          {FN71          } {FD71                   } {F71Z1 }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C721 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN72          } {FD72                   } {F72B1}
                                                     {F72A1}
         <ELSE>
          {FN72          } {FD72                   } {F72Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN72          } {FD72                   } {F72B1}
                                                     {F72A1}
      <ELSE>
          {FN72          } {FD72                   } {F72Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C731 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN73          } {FD73                   } {F73B1   }
                                                     {F73A1   }
         <ELSE>
          {FN73          } {FD73                   } {F73Z1   }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN73          } {FD73                   } {F73B1   }
                                                     {F73A1   }
      <ELSE>
          {FN73          } {FD73                   } {F73Z1   }
      <ENDIF>

   <ENDIF>
 <ENDIF>
  <IF FNUM = '386'>
   <IF %IMODF% <> 'Y' OR CHQ386 = 'Y'>
     <IF KEY386B1 = SPACES>

{ATYP   } {KEY386A1      } {ADTE    } {ATIM  } {AUSER }{ASEQ}  {APROG }
     <ELSE>

{ATYP   } {KEY386B1      } {ADTE    } {ATIM  } {AUSER }{ASEQ}  {APROG }
     <ENDIF>
'Element Code: ' EEEEEEEE
   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C61 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN6           } {FD6                    } {F6B1          }
                                                     {F6A1          }
         <ELSE>
          {FN6           } {FD6                    } {F6Z1          }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN6           } {FD6                    } {F6B1          }
                                                     {F6A1          }
      <ELSE>
          {FN6           } {FD6                    } {F6Z1          }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C201 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN20          } {FD20                   } {F20B1 }
                                                     {F20A1 }
         <ELSE>
          {FN20          } {FD20                   } {F20Z1 }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN20          } {FD20                   } {F20B1 }
                                                     {F20A1 }
      <ELSE>
          {FN20          } {FD20                   } {F20Z1 }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C211 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN21          } {FD21                   } {F21B1}
                                                     {F21A1}
         <ELSE>
          {FN21          } {FD21                   } {F21Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN21          } {FD21                   } {F21B1}
                                                     {F21A1}
      <ELSE>
          {FN21          } {FD21                   } {F21Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C221 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN22          } {FD22                   } {F22B1   }
                                                     {F22A1   }
         <ELSE>
          {FN22          } {FD22                   } {F22Z1   }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN22          } {FD22                   } {F22B1   }
                                                     {F22A1   }
      <ELSE>
          {FN22          } {FD22                   } {F22Z1   }
      <ENDIF>

   <ENDIF>
 <ENDIF>
  <IF FNUM = '387'> 
   <IF %IMODF% <> 'Y' OR CHQ387 = 'Y'>
     <IF KEY387B1 = SPACES>

{ATYP   } {KEY387A1      } {ADTE    } {ATIM   } {AUSER }{ASEQ} {APROG }
     <ELSE>

{ATYP   } {KEY387B1      } {ADTE    } {ATIM   } {AUSER }{ASEQ} {APROG }
     <ENDIF>
'Category Code/Description: 'CC' -' {CDESC                             }
   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C261 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN26          } {FD26                   } {F26B1         }
                                                     {F26A1         }
         <ELSE>
          {FN26          } {FD26                   } {F26Z1         }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN26          } {FD26                   } {F26B1         }
                                                     {F26A1         }
      <ELSE>
          {FN26          } {FD26                   } {F26Z1         }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C271 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN27        } {FD27                   } {F27B1     }
                                                   {F27A1     }
         <ELSE>
          {FN27        } {FD27                   } {F27Z1     }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN27        } {FD27                   } {F27B1     }
                                                   {F27A1     }
      <ELSE>
          {FN27        } {FD27                   } {F27Z1     }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C91 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN9           } {FD9                    } {F9B1}
                                                     {F9A1}
         <ELSE>
          {FN9           } {FD9                    } {F9Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN9           } {FD9                    } {F9B1}
                                                     {F9A1}
      <ELSE>
          {FN9           } {FD9                    } {F9Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C101 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN10          } {FD10                   } {F10B1     }
                                                     {F10A1     }
         <ELSE>
          {FN10          } {FD10                   } {F10Z1     }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN10          } {FD10                   } {F10B1     }
                                                     {F10A1     }
      <ELSE>
          {FN10          } {FD10                   } {F10Z1     }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C331 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN33          } {FD33                   }          {F33B1 }
                                                              {F33A1 }
         <ELSE>
          {FN33          } {FD33                   }          {F33Z1 }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN33          } {FD33                   }          {F33B1 }
                                                              {F33A1 }
      <ELSE>
          {FN33          } {FD33                   }          {F33Z1 }
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C341 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN34          } {FD34                   }           {F34B1}
                                                               {F34A1}
         <ELSE>
          {FN34          } {FD34                   }           {F34Z1}
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN34          } {FD34                   }           {F34B1}
                                                               {F34A1}
      <ELSE>
          {FN34          } {FD34                   }           {F34Z1}
      <ENDIF>

   <ENDIF>
   <IF %IMODF% = 'Y'>
      <IF C351 = 'Y'>
         <IF ATYP = 'Modify'>
          {FN35          } {FD35                   }            {F35B1   }
                                                                {F35A1   }
         <ELSE>
          {FN35          } {FD35                   }            {F35Z1   }
         <ENDIF>

      <ENDIF>
   <ELSE>
      <IF ATYP = 'Modify'>
          {FN35          } {FD35                   }            {F35B1   }
                                                                {F35A1   }
      <ELSE>
          {FN35          } {FD35                   }            {F35Z1   }
      <ENDIF>

   <ENDIF>
 <ENDIF>
<ENDIF>
%REPORT-SUMMARY



                                                 '*** END OF REPORT ***'

%VARIABLES
%***************** EF0607 Start of Change  ********************
        XDAT  = WX-TODAYS-DATE
%*
%* get yesterday
      YDATT = DATE2 of MSSDAT -
               where (OPTION    =  '1',   -
                      DATE1     =  XDAT,  -
                      DAYS      = -1)
%*
%* setup if date range to default
%* i.e. if no input parameter for 'to' date, use yesterday's date (YDATT)
      CDATT = choose (YDATT IF (%ITODTE% = '        '), -
                      YDATT IF (%ITODTE% = '00000000'), -
                      %ITODTE%) I-PIC (9(8))
%*
%* i.e. if no input parameter for 'from' date, use yesterday's date (YDATT)
      CDATF = choose (YDATT IF (%IFRDTE% = '        '), -
                      YDATT IF (%IFRDTE% = '00000000'), -
                      %IFRDTE%) I-PIC (9(8))
%*
%* set a variable if required
%* if date on MSF034 file is with the 'from' and 'to' dates,
%* then set print parameter to 'Y'
      CDTE  = choose ('Y' IF (DATE-GMT >= CDATF AND DATE-GMT <= CDATT), -
                      'N')
%***************** EF0607 End  of Change  ********************
%*
       AUD    = AUDIT-TYPE
       SEQNO  = justifyright (SEQNCE-NO,6) I-PIC (X(6))
       CTYP   = choose ('Y' IF (%ITYP% = SPACES), -
                        'Y' IF (%ITYP% = 'A'), -
                        'Y' IF (%ITYP% = 'C', AUD = 'W'), -
                        'Y' IF (%ITYP% = 'D', AUD = 'D'), -
                        'Y' IF (%ITYP% = 'M', AUD = 'A'), -
                        'Y' IF (%ITYP% = 'M', AUD = 'B'), -
                        'N')
       CUSR   = choose ('Y' IF (%IUSER% = SPACES), -
                        'Y' IF (%IUSER% = USER-ID), -
                        'N')
       ADTE   = DATE-GMT FORMAT (DATE)
       ATIM   = TIME-GMT FORMAT (TIME)
       FNUM   = FILE-NO 
       AUSER  = USER-ID
       APROG  = PROGRAM-NAME
       ASEQ   = SEQNCE-NO
       ATYP   = choose ('Create' IF (AUD = 'W'), -
                        'Delete' IF (AUD = 'D'), -
                        'Modify')
%* MSF384 audit variables
       FN105  = 'CONTRACT-PRICE'            CONSTANT
       FD105  = 'Contract Price'            CONSTANT
       FN110  = 'LAST-MOD-DATE'             CONSTANT
       FD110  = 'Last Modification Date'    CONSTANT
       FN111  = 'LAST-MOD-TIME'             CONSTANT
       FD111  = 'Last Modification Time'    CONSTANT
       FN112  = 'LAST-MOD-USER'             CONSTANT
       FD112  = 'Last Modification User Id' CONSTANT

       KEY384B1 = before-value (MSF384, KEY-384)
       KEY384A1 = after-value (MSF384, KEY-384)

       CNT384 = substr(KEY384A1,1,8) 
       SUPP   = SUPPLIER-NO OF MSF384 - 
                WHERE (CONTRACT-NO = CNT384)
       STAT   = STATUS-384 VIA (SUPP)
       SNAME  = SUPPLIER-NAME OF MSF200 -
                WHERE (SUPPLIER-NO = SUPP)

       C1051  = changed (MSF384, 1/CONTRACT-PRICE, )
       F105B1 = before-value (MSF384, 1/CONTRACT-PRICE, )
       F105A1 = after-value (MSF384, 1/CONTRACT-PRICE, )
       F105Z1 = choose (F105B1 IF (ATYP = 'Delete'), -
                        F105A1 IF (ATYP = 'Create'), -
                        ZERO)
       C1101  = changed (MSF384, 1/LAST-MOD-DATE, )
       F110B1 = before-value (MSF384, 1/LAST-MOD-DATE, )
       F110A1 = after-value (MSF384, 1/LAST-MOD-DATE, )
       F110Z1 = choose (F110B1 IF (ATYP = 'Delete'), -
                        F110A1 IF (ATYP = 'Create'), -
                        SPACES)

       C1111  = changed (MSF384, 1/LAST-MOD-TIME, )
       F111B1 = before-value (MSF384, 1/LAST-MOD-TIME, )
       F111A1 = after-value (MSF384, 1/LAST-MOD-TIME, )
       F111Z1 = choose (F111B1 IF (ATYP = 'Delete'), -
                        F111A1 IF (ATYP = 'Create'), -
                        SPACES)

       C1121  = changed (MSF384, 1/LAST-MOD-USER, )
       F112B1 = before-value (MSF384, 1/LAST-MOD-USER, )
       F112A1 = after-value (MSF384, 1/LAST-MOD-USER, )
       F112Z1 = choose (F112B1 IF (ATYP = 'Delete'), -
                        F112A1 IF (ATYP = 'Create'), -
                        SPACES)
%*   
%*     Set a Flag if Any changes
       CHQ384 = CHOOSE('Y' IF(C1051 = 'Y' OR -
                              C1101 = 'Y' OR -
                              C1111 = 'Y' OR -
                              C1121 = 'Y'),'N')
%* End of MSF384 variables

%* MSF385 audit variables
       FN7    = 'PORTION-VAL'               CONSTANT
       FD7    = 'Portion Value'             CONSTANT
       FN14   = 'ORIG-COMPL-DT'             CONSTANT
       FD14   = 'Original Completion Date'  CONSTANT
       FN15   = 'AMEND-COMPL-DT'            CONSTANT
       FD15   = 'Amend Completion Date'     CONSTANT
       FD15O  = 'Amend Completion Date - O' CONSTANT
       FD15A  = '                      - B' CONSTANT
       FD15L  = '                      - A' CONSTANT
       FN23   = 'LIQ-DAM-RATE'              CONSTANT
       FD23   = 'Liquidated Damages Rate'   CONSTANT
       FN24   = 'LIQ-DAM-BASE'              CONSTANT
       FD24   = 'Liquidated Damages Base'   CONSTANT
       FN25   = 'LIQ-DAM-LIMIT'             CONSTANT
       FD25   = 'Liquid Damages Limit'      CONSTANT
       FN2W   = 'WARR-UNIT'                 CONSTANT
       FD2W   = 'Warranty Unit'             CONSTANT
       FN28   = 'WARR-BASE'                 CONSTANT
       FD28   = 'Warranty Base'             CONSTANT
       FN29   = 'WARR-UNIT-ALT'             CONSTANT
       FD29   = 'Warranty Unit Alternate'   CONSTANT
       FN30   = 'WARR-UNIT-BASE'            CONSTANT
       FD30   = 'Warranty Unit Base'        CONSTANT
       FN71   = 'LAST-MOD-DATE'             CONSTANT
       FD71   = 'Last Modification Date'    CONSTANT
       FN72   = 'LAST-MOD-TIME'             CONSTANT
       FD72   = 'Last Modification Time'    CONSTANT
       FN73   = 'LAST-MOD-USER'             CONSTANT
       FD73   = 'Last Modification User Id' CONSTANT

       KEY385B1 = before-value (MSF385, KEY-385)
       KEY385A1 = after-value (MSF385, KEY-385)

       C71    = changed (MSF385, 1/PORTION-VAL, )
       F7B1   = before-value (MSF385, 1/PORTION-VAL, )
       F7A1   = after-value (MSF385, 1/PORTION-VAL, )
       F7Z1   = choose (F7B1 IF (ATYP = 'Delete'), -
                        F7A1 IF (ATYP = 'Create'), -
                        ZERO)

       C141   = changed (MSF385, 1/ORIG-COMPL-DT, )
       F14B1  = before-value (MSF385, 1/ORIG-COMPL-DT, )
       F14A1  = after-value (MSF385, 1/ORIG-COMPL-DT, )
       F14Z1  = choose (F14B1 IF (ATYP = 'Delete'), -
                        F14A1 IF (ATYP = 'Create'), -
                        SPACES)

       C151   = changed (MSF385, 1/AMEND-COMPL-DT, )
       F15B1  = before-value (MSF385, 1/AMEND-COMPL-DT, )
       F15A1  = after-value (MSF385, 1/AMEND-COMPL-DT, )
       F15Z1  = choose (F15B1 IF (ATYP = 'Delete'), -
                        F15A1 IF (ATYP = 'Create'), -
                        SPACES)

       C231   = changed (MSF385, 1/LIQ-DAM-RATE, )
       F23B1  = before-value (MSF385, 1/LIQ-DAM-RATE, )
       F23A1  = after-value (MSF385, 1/LIQ-DAM-RATE, )
       F23Z1  = choose (F23B1 IF (ATYP = 'Delete'), -
                        F23A1 IF (ATYP = 'Create'), -
                        ZERO)

       C241   = changed (MSF385, 1/LIQ-DAM-BASE, )
       F24B1  = before-value (MSF385, 1/LIQ-DAM-BASE, )
       F24A1  = after-value (MSF385, 1/LIQ-DAM-BASE, )
       F24Z1  = choose (F24B1 IF (ATYP = 'Delete'), -
                        F24A1 IF (ATYP = 'Create'), -
                        SPACES)

       C251   = changed (MSF385, 1/LIQ-DAM-LIMIT, )
       F25B1  = before-value (MSF385, 1/LIQ-DAM-LIMIT, )
       F25A1  = after-value (MSF385, 1/LIQ-DAM-LIMIT, )
       F25Z1  = choose (F25B1 IF (ATYP = 'Delete'), -
                        F25A1 IF (ATYP = 'Create'), -
                        ZERO)

       C2W1   = changed (MSF385, 1/WARR-UNIT, )
       F2WB1  = before-value (MSF385, 1/WARR-UNIT, )
       F2WA1  = after-value (MSF385, 1/WARR-UNIT, )
       F2WZ1  = choose (F2WB1 IF (ATYP = 'Delete'), -
                        F2WA1 IF (ATYP = 'Create'), -
                        ZERO)

       C281   = changed (MSF385, 1/WARR-BASE, )
       F28B1  = before-value (MSF385, 1/WARR-BASE, )
       F28A1  = after-value (MSF385, 1/WARR-BASE, )
       F28Z1  = choose (F28B1 IF (ATYP = 'Delete'), -
                        F28A1 IF (ATYP = 'Create'), -
                        SPACES)

       C291   = changed (MSF385, 1/WARR-UNIT-ALT, )
       F29B1  = before-value (MSF385, 1/WARR-UNIT-ALT, )
       F29A1  = after-value (MSF385, 1/WARR-UNIT-ALT, )
       F29Z1  = choose (F29B1 IF (ATYP = 'Delete'), -
                        F29A1 IF (ATYP = 'Create'), -
                        ZERO)
       C301   = changed (MSF385, 1/WARR-UNIT-BASE, )
       F30B1  = before-value (MSF385, 1/WARR-UNIT-BASE, )
       F30A1  = after-value (MSF385, 1/WARR-UNIT-BASE, )
       F30Z1  = choose (F30B1 IF (ATYP = 'Delete'), -
                        F30A1 IF (ATYP = 'Create'), -
                        SPACES)

       C711   = changed (MSF385, 1/LAST-MOD-DATE, )
       F71B1  = before-value (MSF385, 1/LAST-MOD-DATE, )
       F71A1  = after-value (MSF385, 1/LAST-MOD-DATE, )
       F71Z1  = choose (F71B1 IF (ATYP = 'Delete'), -
                        F71A1 IF (ATYP = 'Create'), -
                        SPACES)

       C721   = changed (MSF385, 1/LAST-MOD-TIME, )
       F72B1  = before-value (MSF385, 1/LAST-MOD-TIME, )
       F72A1  = after-value (MSF385, 1/LAST-MOD-TIME, )
       F72Z1  = choose (F72B1 IF (ATYP = 'Delete'), -
                        F72A1 IF (ATYP = 'Create'), -
                        SPACES)

       C731   = changed (MSF385, 1/LAST-MOD-USER, )
       F73B1  = before-value (MSF385, 1/LAST-MOD-USER, )
       F73A1  = after-value (MSF385, 1/LAST-MOD-USER, )
       F73Z1  = choose (F73B1 IF (ATYP = 'Delete'), -
                        F73A1 IF (ATYP = 'Create'), -
                        SPACES)
%*
%*     Set a Flag if Any changes
       CHQ385 = CHOOSE('Y' IF(C71   = 'Y' OR -
                              C141  = 'Y' OR -
                              C151  = 'Y' OR -
                              C231  = 'Y' OR -
                              C241  = 'Y' OR -
                              C251  = 'Y' OR -
                              C2W1  = 'Y' OR -
                              C281  = 'Y' OR -
                              C291  = 'Y' OR -
                              C301  = 'Y' OR -
                              C711  = 'Y' OR -
                              C721  = 'Y' OR -
                              C731  = 'Y'),'N')

%* End of 385 variables
%* MSF386 audit variables
       FN6    = 'ELEMENT-VAL'               CONSTANT
       FD6    = 'Element Value'             CONSTANT
       FN20   = 'LAST-MOD-DATE'             CONSTANT
       FD20   = 'Last Modification Date'    CONSTANT
       FN21   = 'LAST-MOD-TIME'             CONSTANT
       FD21   = 'Last Modification Time'    CONSTANT
       FN22   = 'LAST-MOD-USER'             CONSTANT
       FD22   = 'Last Modification User Id' CONSTANT

       KEY386B1 = before-value (MSF386, KEY-386)
       KEY386A1 = after-value (MSF386, KEY-386)

       CNT386 = substr(KEY386A1,1,8) 
       POR386 = substr(KEY386A1,9,2)  
       ELE386 = substr(KEY386A1,11,2)
       E      = ELEMENT-CODE OF MSF386 -
                WHERE (CONTRACT-NO = CNT386, -
                       PORTION-NO  = POR386, -
                       ELEMENT-NO  = ELE386)

       C61    = changed (MSF386, 1/ELEMENT-VAL, )
       F6B1   = before-value (MSF386, 1/ELEMENT-VAL, )
       F6A1   = after-value (MSF386, 1/ELEMENT-VAL, )
       F6Z1   = choose (F6B1 IF (ATYP = 'Delete'), -
                        F6A1 IF (ATYP = 'Create'), -
                        ZERO)
       C201   = changed (MSF386, 1/LAST-MOD-DATE, )
       F20B1  = before-value (MSF386, 1/LAST-MOD-DATE, )
       F20A1  = after-value (MSF386, 1/LAST-MOD-DATE, )
       F20Z1  = choose (F20B1 IF (ATYP = 'Delete'), -
                        F20A1 IF (ATYP = 'Create'), -
                        SPACES)

       C211   = changed (MSF386, 1/LAST-MOD-TIME, )
       F21B1  = before-value (MSF386, 1/LAST-MOD-TIME, )
       F21A1  = after-value (MSF386, 1/LAST-MOD-TIME, )
       F21Z1  = choose (F21B1 IF (ATYP = 'Delete'), -
                        F21A1 IF (ATYP = 'Create'), -
                        SPACES)

       C221   = changed (MSF386, 1/LAST-MOD-USER, )
       F22B1  = before-value (MSF386, 1/LAST-MOD-USER, )
       F22A1  = after-value (MSF386, 1/LAST-MOD-USER, )
       F22Z1  = choose (F22B1 IF (ATYP = 'Delete'), -
                        F22A1 IF (ATYP = 'Create'), -
                        SPACES)

%*
%*     Set a Flag if Any changes
       CHQ386 = CHOOSE('Y' IF(C61   = 'Y' OR -
                              C201  = 'Y' OR -
                              C211  = 'Y' OR -
                              C221  = 'Y'),'N')
%* End of 386 variables
%* MSF387 variables     
       KEY387B1 = before-value (MSF387, KEY-387)
       KEY387A1 = after-value (MSF387, KEY-387)

       CNT387 = substr(KEY387A1,1,8) 
       POR387 = substr(KEY387A1,9,2) 
       ELE387 = substr(KEY387A1,11,2)
       CAT387 = substr(KEY387A1,13,2)
       CDESC  = CATEG-DESC OF MSF387 -
                WHERE (CONTRACT-NO = CNT387, -
                       PORTION-NO  = POR387, -
                       ELEMENT-NO  = ELE387, -
                       CATEGORY-NO = CAT387)
       C      = CATEG-CODE VIA (CDESC)

       FN26   = 'CATEG-BASE-PRI'            CONSTANT
       FD26   = 'Category Base Price'       CONSTANT
       FN27   = 'CATEG-BASE-PRC'            CONSTANT
       FD27   = 'Category Base Price Rate'  CONSTANT
       FN9    = 'CATEG-BASE-UN'             CONSTANT
       FD9    = 'Category Base Unit'        CONSTANT
       FN10   = 'CATEG-BASE-QTY'            CONSTANT
       FD10   = 'Category Base Quantity'    CONSTANT
       FN33   = 'LAST-MOD-DATE'             CONSTANT
       FD33   = 'Last Modification Date'    CONSTANT
       FN34   = 'LAST-MOD-TIME'             CONSTANT
       FD34   = 'Last Modification Time'    CONSTANT
       FN35   = 'LAST-MOD-USER'             CONSTANT
       FD35   = 'Last Modification User Id' CONSTANT

       C261   = changed (MSF387, 1/CATEG-BASE-PRICE, )
       F26B1  = before-value (MSF387, 1/CATEG-BASE-PRICE, )
       F26A1  = after-value (MSF387, 1/CATEG-BASE-PRICE, )
       F26Z1  = choose (F26B1 IF (ATYP = 'Delete'), -
                        F26A1 IF (ATYP = 'Create'), -
                        ZERO)

       C271   = changed (MSF387, 1/CATEG-BASE-PRC-RT, )
       F27B1  = before-value (MSF387, 1/CATEG-BASE-PRC-RT, )
       F27A1  = after-value (MSF387, 1/CATEG-BASE-PRC-RT, )
       F27Z1  = choose (F27B1 IF (ATYP = 'Delete'), -
                        F27A1 IF (ATYP = 'Create'), -
                        ZERO)
       C91    = changed (MSF387, 1/CATEG-BASE-UN, )
       F9B1   = before-value (MSF387, 1/CATEG-BASE-UN, )
       F9A1   = after-value (MSF387, 1/CATEG-BASE-UN, )
       F9Z1   = choose (F9B1 IF (ATYP = 'Delete'), -
                        F9A1 IF (ATYP = 'Create'), -
                        SPACES)

       C101   = changed (MSF387, 1/CATEG-BASE-QTY, )
       F10B1  = before-value (MSF387, 1/CATEG-BASE-QTY, )
       F10A1  = after-value (MSF387, 1/CATEG-BASE-QTY, )
       F10Z1  = choose (F10B1 IF (ATYP = 'Delete'), -
                        F10A1 IF (ATYP = 'Create'), -
                        ZERO)
       C331   = changed (MSF387, 1/LAST-MOD-DATE, )
       F33B1  = before-value (MSF387, 1/LAST-MOD-DATE, )
       F33A1  = after-value (MSF387, 1/LAST-MOD-DATE, )
       F33Z1  = choose (F33B1 IF (ATYP = 'Delete'), -
                        F33A1 IF (ATYP = 'Create'), -
                        SPACES)

       C341   = changed (MSF387, 1/LAST-MOD-TIME, )
       F34B1  = before-value (MSF387, 1/LAST-MOD-TIME, )
       F34A1  = after-value (MSF387, 1/LAST-MOD-TIME, )
       F34Z1  = choose (F34B1 IF (ATYP = 'Delete'), -
                        F34A1 IF (ATYP = 'Create'), -
                        SPACES)

       C351   = changed (MSF387, 1/LAST-MOD-USER, )
       F35B1  = before-value (MSF387, 1/LAST-MOD-USER, )
       F35A1  = after-value (MSF387, 1/LAST-MOD-USER, )
       F35Z1  = choose (F35B1 IF (ATYP = 'Delete'), -
                        F35A1 IF (ATYP = 'Create'), -
                        SPACES)
%*
%*     Set a Flag if Any changes
       CHQ387 = CHOOSE('Y' IF(C261  = 'Y' OR -
                              C271  = 'Y' OR -
                              C91   = 'Y' OR -
                              C101  = 'Y' OR -
                              C331  = 'Y' OR -
                              C341  = 'Y' OR -
                              C351  = 'Y'),'N')

%* End of 387 variables - and indeed end of Program 
